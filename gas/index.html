<!DOCTYPE html>
<head profile="http://www.w3.org/2005/10/profile">
<link rel="icon" 
      type="image/png" 
      href="https://sites.google.com/site/recgtasks/images/icon%20150828.png">
</head>

<!-- html, head & body tags added automatically - see https://developers.google.com/apps-script/guides/html/best-practices#dont_use_html_head_or_body_tags -->

<?!= HtmlService.createHtmlOutputFromFile('stylesheet').getContent(); ?>

<!-- ********** NAVIGATION BAR -->

<div class="app">

<div id="navBar" class="navBar">
  <div style="height:77px">
    <img src="https://sites.google.com/site/recgtasks/images/navbar-logo.png" alt="Logo">
  </div>
  
  <div class="navBarBlank" style="height:77px">
    <br/>
  </div>
  
  <div id="navBarItmOverview" class="navBarItem">
    <br/>
  </div>
  
  <div id="navBarItmManage" class="navBarItem" >
    <br/>
  </div>

  <div id="navBarItmSettings" class="navBarItem" >
    <br/>
  </div>

  <div class="navBarBlank">
    <br/>
  </div>

</div>

<div id="sections" class="sections">

<!-- ********** MAIN/OVERVIEW -->

<div id="sectionMain" class="section">
  <h1>Recurrent Tasks</h1>
  <h1 class="subtitle"> for Google Tasks&trade;</h1>
  <p>
    This application enables you using repeating/recurrent tasks in  
    <a href="https://mail.google.com/tasks/canvas" target="_blank">Google Tasks&trade;</a>,
    without any special, additional service.
  </p>
  <p>
    All you need to do is:
  </p>
  <ol>
      <li>Make sure settings of this app are right for you (e.g. date format &amp; first day of week). 
          You can change them anytime, but such change can create e.g. task duplicates. </li>
      <li>Create new, special, task list - which will contain recurrent tasks definitions.</li>
      <li>Create few recurrent tasks (in that special task list) - recurrence pattern is stored in the task notes.</li>
      <li>Wait 60 minutes, or run recurrent task processing manually (see below).</li>
  </ol>
  <p>    
    Alternatively, you can <a class="linkExample" href="">click here</a> to create an example 
    of a task list containing recurrent task templates. After that you can tweak them and run processing 
    of recurrent tasks manually (see bellow) and see results for yourself.
  </p>

  <table>
    <tr style="vertical-align:top">
      <td> <img src="https://sites.google.com/site/recgtasks/images/questionmark.png" alt="help"> </td>
      <td>  
        <h2>Finding help/info</h2>
        <p>
          If you need additional info, please, refer to 
          <a href="https://github.com/jsdev2015/recgtasks/wiki" target="_blank"> project's wiki.</a>.<br/><br/>

        </p>
      </td>
    </tr>
    <tr style="vertical-align:top">
      <td> <img src="https://sites.google.com/site/recgtasks/images/mouseclick.png" alt="manual run"> </td>
      <td>
        <h2>Manual Run</h2>
        <p>
          Normal tasks are generated from recurrent tasks templates automatically every 60 minutes, 
          but you can start the process manually by clicking button below.
        </p>
  
      </td>
    <tr style="vertical-align:top">
      <td/>
      <td>
        <button type="button" id="btnRunNow">Process recurrent tasks now</button> 
        <span id="btnRunNowStatus"> ... click button to run </span>
        <p/>
      </td>
    </tr>
    <tr style="vertical-align:top">
      <td> <img src="https://sites.google.com/site/recgtasks/images/clock.png" alt="last run"> </td>
      <td>
        <h2>Last Run</h2>
        <p/>
        <table>
          <tr>
            <td><b>Started at:</b></td> <td><span id="execStarted"> .</span></td>
          </tr>
          <tr>
            <td><b>Finished at:</b></td> <td><span id="execFinished"> .</span></td>
          </tr>
        </table>
        <p/>
        <button type="button" id="btnShowLog">Show Log</button>
      </td>
    </tr>
  </table>
</div>

<!-- ********** SHOW LOG FILE -->

<div id="sectionLogFile" class="section" >
  <h1>Recurrent Tasks</h1>
  <h1 class="subtitle"> for Google Tasks&trade;</h1>
  <h2>Execution Log</h2>
  <button type="button" id="btnShowMain">Back</button>
  <div id="logfile" class="log">
    .. empty page?
  </div>
</div>

<!-- ********** MANAGE TASKS -->

<div id="sectionManage" class="section">
  <h1>Recurrent Tasks</h1>
  <h1 class="subtitle"> for Google Tasks&trade;</h1>
  <h2>Manage Tasks</h2>
  <p> Select recurrent task list template (RTTL) and add/modify/remove recurrent task template.</p>

  <div style="padding-bottom:10pt">
    <label for="tasklist">Select a task list: </label>
    <select id="tasklist">
      <option>Loading...</option>
    </select>
  </div>
  
  <div id="noTaskListsPanel" style="padding-bottom:10pt">
    <p style="color:red"> No RTTL task list found. <a class="linkExample" href="">Click here</a> to create example task list containing templates of recurrent tasks. </p>
  </div>

  <div class="taskTableHeader"> <h2>Tasks</h2></div>
  <table id="tasks" width="100%">
    <tr><td> Loading... </td></tr>
  </table>

</div>

<!-- ********** SETTINGS -->

<div id="sectionSettings" class="section">
  <h1>Recurrent Tasks</h1>
  <h1 class="subtitle"> for Google Tasks&trade;</h1>
  <h2>Settings</h2>
  <p> Configure application settings.</p>

  <form name="settings" id="frmSettings" >
    <div class="setting">
      <div class="settings3">RTTL Name Prefix:</div>
      <div class="settings3"><input type="text" name="rttl-prefix" id="rttl-prefix" /> </div>
      <div class="settings3"><span id="rttl-count">?</span> existing list(s).</div>
    </div>      
    
    <div class="setting help-settings">
      "RTTL prefix" is used to distinguish recurrent task lists (those used for storing recurrent tasks) from normal task lists. Every task list which would contain recurrent tasks should have title prefixed with this prefix.
    </div>
    
    <div class="setting">
      <div class="settings3">Destination Task List:</div>
      <div class="settings3">
        <select id="dest-tasklist">
          <option>- Empty -</option>
        </select>
      </div>
      <div class="settings3"><br/></div>
    </div>

    <div class="setting help-settings">
      "Destination Task List" is a task list into which app is going to crete tasks based on recurrent task templates. This should be your daily used task list.
    </div>

    <div class="setting">
      <div class="settings3">Processing Date Range:</div>
      <div class="settings3">
        <select id="dest-range">
          <option value="14">2 weeks</option>
          <option value="21">3 weeks</option>
          <option value="28">4 weeks</option>
          <option value="42">6 weeks</option>
          <option value="56">8 weeks</option>
        </select>
      </div>
      <div class="settings3"><br/></div>
    </div>

    <div class="setting help-settings">
      "Processing Date Range" is a number of days into the future for which app is going to create tasks from task templates. E.g. 3 weeks, means app will limit creation of tasks to 21 day from the day it calculates the tasks.
    </div>


    <div class="setting">
      <div class="settings3">Log Verbosity Level:</div>
      <div class="settings3">
        <select id="log-level">
          <option value="1">Only critical messages</option>
          <option value="2">Warnings too</option>
          <option value="3">Show info</option>
          <option value="4">Even extended info</option>
          <option value="10">Include Developer info</option>
        </select>
      </div>
      <div class="settings3"><br/></div>
    </div>
    
    <div class="setting help-settings">
      "Log Verbosity Level" defines how many detail app will put into a log file. Log file can help you in case you will feel something is not right. When contacting support, make sure to set it to "Developer" level.
    </div>

    <div class="setting">
      <div class="settings3">Date format:</div>
      <div class="settings3">
        <select id="dateFmt">
          <option value="1">Old: MM/DD YYYY-DD-MM</option>
          <option value="2"> US: MM/DD MM/DD/YYYY</option>
          <option value="3"> UK: DD/MM DD/MM/YYYY</option>
        </select>
      </div>
      <div class="settings3"><br/></div>
    </div>
    
    <div class="setting help-settings">
      "Date Format" impacts how dates are understood. It impacts both "yearly" recurrence type, 
      where you need to specity month and day of year (MM/DD or DD/MM), and dates entered 
      for start and end of the task validity (YYYY-MM-DD, MM/DD/YYYY, DD/MM/YYYY).
      <p style="color:red"> Changing this setting WILL require you to modify recurrence patterns
      in your recurrent tasks notes to comform new format as the old ones might be wrongly understood.</p>
    </div>

    <div class="setting">
      <div class="settings3">Week Starts on</div>
      <div class="settings3">
        <select id="weekStart">
          <option value="S">Sunday</option>
          <option value="M">Monday</option>
        </select>
      </div>
      <div class="settings3"><br/></div>
    </div>
    
    <div class="setting help-settings">
      "Week Starts On" impacts how tasks repeating weekly are evaluated as 1-7 stands for Sunday-Saturday if week starts on Sunday,
      but 1-7 stands for Monday-Sunday if week starts on Monday.
      <p style="color:red"> Changing this setting WILL initially create duplicates for tasks recurring weekly. 
      Please, modify this only if you have only few recurring tasks 
      or you are ready to perform manual task clensing afterwards.</p>
    </div>


    <div class="setting">
      <input type="submit" name="save" id="btnSaveSettings" value="Save Settings" />
      <span id="frmSaveStatus"></span>
    </div>

  </form>
</div>

</div> 
<!-- ********** END OF SECTIONS -->

</div>
<!-- ********** END OF APP -->

<?!= HtmlService.createHtmlOutputFromFile('scripts-gen-tasks').getContent(); ?>
<?!= HtmlService.createHtmlOutputFromFile('scripts-settings').getContent(); ?>
<?!= HtmlService.createHtmlOutputFromFile('scripts-manage').getContent(); ?>
<?!= HtmlService.createHtmlOutputFromFile('scripts-main').getContent(); ?>

<?!= HtmlService.createHtmlOutputFromFile('scripts').getContent(); ?>



